<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>JavaEE之MyBatis基础知识之上小结 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="MyBatis1. 基础知识（重点，内容多）     对原生态jdbc程序（单独使用jdbc开发）问题总结     mybatis框架原理（掌握）     mybatis入门程序          用户的增删改查     mybatis开发两种方法：          原始dao开发方法（程序需要编写dao接口和dao实现类）（掌握）          mybaits的mapper接口（相当于da">
<meta name="keywords" content="javaEE_基础">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaEE之MyBatis基础知识之上小结">
<meta property="og:url" content="https://github.com/570911275/570911275.github.io/2019/07/24/JavaEE之MyBatis基础知识之上小结/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="MyBatis1. 基础知识（重点，内容多）     对原生态jdbc程序（单独使用jdbc开发）问题总结     mybatis框架原理（掌握）     mybatis入门程序          用户的增删改查     mybatis开发两种方法：          原始dao开发方法（程序需要编写dao接口和dao实现类）（掌握）          mybaits的mapper接口（相当于da">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-07-27T05:07:24.371Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JavaEE之MyBatis基础知识之上小结">
<meta name="twitter:description" content="MyBatis1. 基础知识（重点，内容多）     对原生态jdbc程序（单独使用jdbc开发）问题总结     mybatis框架原理（掌握）     mybatis入门程序          用户的增删改查     mybatis开发两种方法：          原始dao开发方法（程序需要编写dao接口和dao实现类）（掌握）          mybaits的mapper接口（相当于da">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://github.com/570911275/570911275.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-JavaEE之MyBatis基础知识之上小结" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/24/JavaEE之MyBatis基础知识之上小结/" class="article-date">
  <time datetime="2019-07-24T07:34:16.000Z" itemprop="datePublished">2019-07-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      JavaEE之MyBatis基础知识之上小结
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="MyBatis"><a href="#MyBatis" class="headerlink" title="MyBatis"></a>MyBatis</h2><pre><code>1. 基础知识（重点，内容多）
    对原生态jdbc程序（单独使用jdbc开发）问题总结
    mybatis框架原理（掌握）
    mybatis入门程序
         用户的增删改查
    mybatis开发两种方法：
         原始dao开发方法（程序需要编写dao接口和dao实现类）（掌握）
         mybaits的mapper接口（相当于dao接口）代理开发方法（掌握）
    mybatis配置文件SqlMapConfig.xml
    mybatis核心：
         mybatis输入映射（掌握）
         mybatis输出映射（掌握）
    mybatis的动态SQL（掌握）

 2. 高级知识
    订单商品数据模型分析
    高级结果集映射（一对一，一对多，多对多）
    mybatis延迟加载
    mybatis查询缓冲（一级缓冲、二级缓冲）
    mybaits和spring进行整合（掌握）
    mybatis逆向工程
</code></pre><h3 id="一、基础知识"><a href="#一、基础知识" class="headerlink" title="一、基础知识"></a>一、基础知识</h3><h4 id="1-对原生jdbc程序问题总结"><a href="#1-对原生jdbc程序问题总结" class="headerlink" title="1. 对原生jdbc程序问题总结"></a>1. 对原生jdbc程序问题总结</h4><pre><code>1.1 环境搭建：
     * java环境：jdk
     * 数据库环境：mysql
     * 集成开发环境：idea

1.2 创建mysql数据库
     * sql_data.sql：记录表结构
     * sql_table.sql：记录测试数据，在实际企业开发中，最后提供一个初始化数据脚本

1.3 jdbc程序
     * 使用jdbc程序查询mysql数据库中用户表的记录
         * 创建java工程
         * 导入jar包（数据库驱动包）
         * 编写java程序代码

1.4 问题总结
     1. 数据库连接使用时就创建，不使用立即释放，对数据库进行频繁连接开启和关闭，造成数据库资源浪费影响数据库性能
         * 解决方案：
             * 使用数据库连接池管理数据库连接

     2. 将SQL语句硬编码（SQL语句在java代码中写死）到java中，如果SQL语句修改，需要重新编译java代码，不利于系统维护
         * 解决方案：
              * 将SQL语句配置在xml配置文件中，即使SQL变化，不需要对java代码进行重新编译

     3. 向preparedStatement中设置参数，对占位符位置和设置参数值，硬编码在java代码中，不利于系统维护
         * 解决方案：
              * 将SQL语句以及占位符合和参数全部配置在xml文件中

     4. 从resutSet中遍历结果集数据时，存在硬编码，将获取表的字段进行硬编码，不利于系统卫华
         * 解决方案：
              * 将查询的结果集，自动映射成java对象   
</code></pre><h4 id="2-mybatis框架"><a href="#2-mybatis框架" class="headerlink" title="2.mybatis框架"></a>2.mybatis框架</h4><pre><code>2.1 mybatis是什么
     * mybatis是一个持久层的框架，是Apache下的顶级项目
     * mybatis托管到goolecode下，再后来托管到github下
     * mybatis让程序员将主要精力放在SQL上，通过mybatis提供的映射方式，自由灵活生成（半自动化，大部分需要程序员编写SQL）满足SQL语句
     * mybatis可以将向preparedStatement中的输入参数自动输入映射，将查询结果集灵活映射出java对象（输出映射）

2.2 mybatis框架
        —————————————————————————————————————————————————————————————————           
        | * SqlMapConfig.xml(是mybatis的全局配置文件，名称不固定的)         
        | * 配置了数据源、事务等mybatis运行环境                             
        | * 配置映射文件（配置SQL语句）                                     
        |      * 配置在mapper.xml(映射文件)、mapper.xml\mapper.xml....中    
        |                                                                 
        ——————————————————————————————————————————————————————————————————
                                 ||
                                 ||
                                 \/
       ————————————————————————————————————————————————————————————————————
       |  * SqlSessionFactory(会话工厂)【根据配置文件创建工程】
       |     * 作用：创建SqlSession
       —————————————————————————————————————————————————————————————————————
                                 ||
                                 ||
                                 \/
      ————————————————————————————————————————————————————————————————————————
     |   * SqlSession（会话）【面向用户（程序员）的接口】
     |     * 作用：操作数据库（发出SQL增、删、改、查）
      _________________________________________________________________________
                                 ||
                                 ||
                                 \/
      —————————————————————————————————————————————————————————————————————————— 
     |   * Executor(执行器)【是一个接口(基本执行器，缓冲执行器)】
     |      * 作用：SqlSession内部通过执行器操作数据库
      ———————————————————————————————————————————————————————————————————————————   
                                 ||
                                 ||
                                 \/
      ————————————                                                            ——————————
     *|  输入参数  |                                                          |  输出结果
     *|  类型      |    ————————————————————————————————————————————————      |  类型
      |            |   |  * mapped ststement(底层封装对象)               |     |
     *|  java简单  |——&gt; |         * 作用：对操作数据库存储封装，包括SQL语句 |——&gt;  | java简单
     *|  类型      |    |             **输入参数、输出结果类型**          |     | 类型 
     *|  hashmap   |    ————————————————————————————————————————————————     |  hashmap 
      |            |                 ||                                      |
     *|  pojo自定义 |                 ||                                     | polo自定义 
      —————————————                 \  /                                       ——————————————
                                 ——————————————        
     *                          | mysql数据库 
     *                          ————————————————
</code></pre><h4 id="3-入门程序"><a href="#3-入门程序" class="headerlink" title="3.入门程序"></a>3.入门程序</h4><h5 id="3-1-需求"><a href="#3-1-需求" class="headerlink" title="3.1 需求"></a>3.1 需求</h5><pre><code>* 根据用户id（主键）查询用户信息
* 根据用户名称模糊查询用户信息
* 添加用户
* 删除用户
* 更新用户
</code></pre><h5 id="3-2-环境"><a href="#3-2-环境" class="headerlink" title="3.2 环境"></a>3.2 环境</h5><pre><code>* java环境：jdk
* 数据库环境：mysql
* 集成开发环境：idea
* mybatis运行环境：jar包
</code></pre><h5 id="3-3-根据用户id查询用户信息"><a href="#3-3-根据用户id查询用户信息" class="headerlink" title="3.3 根据用户id查询用户信息"></a>3.3 根据用户id查询用户信息</h5><pre><code>1. 映射文件命名：
    Userxml（原始ibatis命名），mapper代理开发映射文件名称叫xxxMapper.xml，比如：UserMapper.xml
2. 在映射文件中配置SQL语句
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">**测试类**</span><br><span class="line"></span><br><span class="line">package cn.itcast.first;</span><br><span class="line"></span><br><span class="line">import cn.itcast.po.User;</span><br><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.*;</span><br><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line"></span><br><span class="line">public class myBatisFirst &#123;</span><br><span class="line">    //1.根据id查询用户信息，得到一条记录结果</span><br><span class="line">    @Test</span><br><span class="line">    public void findUserByIdTest()  &#123;</span><br><span class="line">        User user = null;</span><br><span class="line">        SqlSession sqlSession = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            //mybatis配置文件</span><br><span class="line">            String resource = &quot;SqlMapConfig.xml&quot;;</span><br><span class="line">            //得到配置文件流</span><br><span class="line">            InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">            //创建会话工厂,传入mybatis的配置文件信息</span><br><span class="line">            SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">            //通过工厂得到SqlSession</span><br><span class="line">            sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">            //通过SqlSession操作数据库</span><br><span class="line">            //第一个参数：映射文件中Statement的id,等于namespace+&quot;.&quot;+statement的id</span><br><span class="line">            //第二个参数：指定和映射文件中所匹配的paramenterType类型的参数</span><br><span class="line">            //sqlSession.selectOne结果是于映射文件中所匹配的resultType类型的对象</span><br><span class="line">            user = sqlSession.selectOne(&quot;test.findUserById&quot;,1);</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">**SqlMapConfig.xml**</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;!-- 和spring整合后 environments配置将废除--&gt;</span><br><span class="line">    &lt;environments default=&quot;development&quot;&gt;</span><br><span class="line">        &lt;environment id=&quot;development&quot;&gt;</span><br><span class="line">            &lt;!-- 使用jdbc事务管理，事务控制有mybatis控制--&gt;</span><br><span class="line">            &lt;transactionManager type=&quot;JDBC&quot; /&gt;</span><br><span class="line">            &lt;!-- 数据库连接池--&gt;</span><br><span class="line">            &lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">                &lt;property name=&quot;driver&quot; value=&quot;com.mysql.cj.jdbc.Driver&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;username&quot; value=&quot;root&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;password&quot; value=&quot;a570911275&quot; /&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/environment&gt;</span><br><span class="line">    &lt;/environments&gt;</span><br><span class="line">    &lt;!--加载映射文件--&gt;</span><br><span class="line">    &lt;mappers&gt;</span><br><span class="line">        &lt;mapper resource=&quot;User.xml&quot;/&gt;</span><br><span class="line">    &lt;/mappers&gt;</span><br><span class="line"></span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line"></span><br><span class="line">**User.xml(映射文件)**</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;!--namespce命名空间，作用就是对SQL进行分类化管理，SQL隔离--&gt;</span><br><span class="line">&lt;!--使用mapper代理开发，namespace有特殊的重要作用--&gt;</span><br><span class="line">&lt;mapper namespace=&quot;test&quot;&gt;</span><br><span class="line">    &lt;!--在映射文件中配置SQL语句--&gt;</span><br><span class="line">    &lt;!--通过select执行数据库查询--&gt;</span><br><span class="line">    &lt;!--id标识映射文件中的SQL，称为statement中的id--&gt;</span><br><span class="line">    &lt;!--将SQL语句封装到mappedStatement对象中--&gt;</span><br><span class="line">    &lt;!--#&#123;&#125;表示一个占位符--&gt;</span><br><span class="line">    &lt;!--parameterType指定输入参数的类型--&gt;</span><br><span class="line">    &lt;!--#&#123;id&#125;其中的id表示接受输入的参数，参数名称就是id，</span><br><span class="line">    如果输入参数是简单类型，#&#123;&#125;中的参数名可以任意--&gt;</span><br><span class="line">    &lt;!--resultType指定输出结果所映射的java对象类型，</span><br><span class="line">    select指定resultType表示将单条记录映射成java对象--&gt;</span><br><span class="line">    &lt;select id=&quot;findUserById&quot; parameterType=&quot;int&quot; resultType=&quot;cn.itcast.po.User&quot;&gt;</span><br><span class="line">         SELECT * FROM USER WHERE id=#&#123;id&#125;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>
<h5 id="3-4-根据用户名称模糊查询用户信息"><a href="#3-4-根据用户名称模糊查询用户信息" class="headerlink" title="3.4 根据用户名称模糊查询用户信息"></a>3.4 根据用户名称模糊查询用户信息</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">**测试类**</span><br><span class="line"></span><br><span class="line">前面创建会话过程同3.2一样</span><br><span class="line">//通过SqlSession操作数据库</span><br><span class="line">//第一个参数：映射文件中Statement的id,等于namespace+&quot;.&quot;+statement的id</span><br><span class="line">//第二个参数：指定和映射文件中所匹配的paramenterType类型的参数</span><br><span class="line">//sqlSession.selectOne结果是于映射文件中所匹配的resultType类型的对象</span><br><span class="line">List&lt;User&gt; list = sqlSession.selectList(&quot;test.findUserByName&quot;, &quot;小明&quot;);</span><br><span class="line">System.out.println(list);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">**User.xml(映射文件)**</span><br><span class="line">    &lt;!--根据用户名称模糊查询用户信息,可能返回多条</span><br><span class="line">        resultType：指定就是单条记录所映射的java对象类型</span><br><span class="line">        $&#123;&#125;：表示拼接SQL串，将接收到的参数内容不加任何修饰拼接在SQL中</span><br><span class="line">        使用$&#123;&#125;拼接SQL，引起SQL注入</span><br><span class="line">        $&#123;value&#125;：接收输入参数的内容，如果传入类型是简单类型的，$&#123;&#125;中只能使用value--&gt;</span><br><span class="line">    &lt;select id=&quot;findUserByName&quot; parameterType=&quot;java.lang.String&quot; resultType=&quot;cn.itcast.po.User&quot;&gt;</span><br><span class="line">        SELECT * FROM USER WHERE USERNAME LIKE &apos;%$&#123;value&#125;%&apos;</span><br><span class="line">    &lt;/select&gt;</span><br></pre></td></tr></table></figure>
<h5 id="3-5-添加用户"><a href="#3-5-添加用户" class="headerlink" title="3.5 添加用户"></a>3.5 添加用户</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">**测试类**</span><br><span class="line"></span><br><span class="line">            //创建User对象</span><br><span class="line">            User user = new User();</span><br><span class="line">            user.setUsername(&quot;黄二丫&quot;);</span><br><span class="line">            user.setBirthday(new Date());</span><br><span class="line">            user.setSex(&quot;1&quot;);</span><br><span class="line">            user.setAddress(&quot;广东陆丰&quot;);</span><br><span class="line">            sqlSession.insert(&quot;test.insertUser&quot;, user);</span><br><span class="line">            //提交事务</span><br><span class="line">            sqlSession.commit();</span><br><span class="line">            //获取用户信息主键</span><br><span class="line">            System.out.println(user.getId());</span><br><span class="line">            //关闭会话</span><br><span class="line">            sqlSession.close();</span><br><span class="line"></span><br><span class="line">**User.xml(映射文件)**</span><br><span class="line">    &lt;insert id=&quot;insertUser&quot; parameterType=&quot;cn.itcast.po.User&quot; &gt;</span><br><span class="line">        &lt;!--</span><br><span class="line">        将插入数据的主键返回，返回到user对象中</span><br><span class="line">        SELECT LAST_INSERT_ID():得到刚insert进去记录的主键值，只适用于自增主键</span><br><span class="line">        keyProperty：将查询到主键值设置到parameterType指定的对象的哪一个属性</span><br><span class="line">        order：SELECT LAST_INSERT_ID()执行顺序，相对于insert语句来说它的执行顺序</span><br><span class="line">        resultType：指定SELECT LAST_INSERT_ID()的结果类型</span><br><span class="line">        --&gt;</span><br><span class="line">        &lt;selectKey keyProperty=&quot;id&quot; order=&quot;AFTER&quot; resultType=&quot;java.lang.Integer&quot;&gt;</span><br><span class="line">            SELECT LAST_INSERT_ID()</span><br><span class="line">        &lt;/selectKey&gt;</span><br><span class="line">        insert into user(username,birthday,sex,address) values(#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span><br><span class="line">        &lt;!--</span><br><span class="line">        使用mysql的uuid()进行主键的返回（非自增主键）</span><br><span class="line">        执行思路：</span><br><span class="line">        先通过uuid()查询到主键，将主键设置到user对象中的id属性</span><br><span class="line">        在insert执行时，从user对象中取出id属性值</span><br><span class="line">        执行uuid()顺序相对于insert语句之前--&gt;</span><br><span class="line">        &lt;selectKey keyProperty=&quot;id&quot; order=&quot;AFTER&quot; resultType=&quot;java.lang.Integer&quot;&gt;</span><br><span class="line">            SELECT uuid()</span><br><span class="line">        &lt;/selectKey&gt;</span><br><span class="line">        insert into user(id,username,birthday,sex,address) values(#&#123;id&#125;,#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span><br><span class="line">    &lt;/insert&gt;</span><br></pre></td></tr></table></figure>
<h5 id="3-6-添加用户-返回主键"><a href="#3-6-添加用户-返回主键" class="headerlink" title="3.6 添加用户__返回主键"></a>3.6 添加用户__返回主键</h5><p>1.返回自增主键：<br>        将插入数据的主键返回，返回到user对象中<br>        SELECT LAST_INSERT_ID():得到刚insert进去记录的主键值，只适用于自增主键<br>        keyProperty：将查询到主键值设置到parameterType指定的对象的哪一个属性<br>        order：SELECT LAST_INSERT_ID()执行顺序，相对于insert语句来说它的执行顺序<br>        resultType：指定SELECT LAST_INSERT_ID()的结果类型<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">        &lt;selectKey keyProperty=&quot;id&quot; order=&quot;AFTER&quot; resultType=&quot;java.lang.Integer&quot;&gt;</span><br><span class="line">            SELECT LAST_INSERT_ID()</span><br><span class="line">        &lt;/selectKey&gt;</span><br><span class="line">``` </span><br><span class="line">2.返回非自增主键</span><br><span class="line">        使用mysql的uuid()进行主键的返回（非自增主键）</span><br><span class="line">        执行思路：</span><br><span class="line">        先通过uuid()查询到主键，将主键设置到user对象中的id属性</span><br><span class="line">        在insert执行时，从user对象中取出id属性值</span><br><span class="line">        执行uuid()顺序相对于insert语句之前</span><br></pre></td></tr></table></figure></p>
<pre><code>&lt;selectKey keyProperty=&quot;id&quot; order=&quot;AFTER&quot; resultType=&quot;java.lang.Integer&quot;&gt;
    SELECT uuid()
&lt;/selectKey&gt;
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">#####      3.7 删除用户</span><br></pre></td></tr></table></figure>
<p><strong>测试类</strong></p>
<pre><code>sqlSession.delete(&quot;deleteUser&quot;,40);
sqlSession.commit();
</code></pre><p><strong>User.xml(映射文件)</strong></p>
<pre><code>&lt;!--删除用户
    根据用户id删除用户--&gt;
&lt;delete id=&quot;deleteUser&quot; parameterType=&quot;java.lang.Integer&quot;&gt;
    delete from user where id = #{id}
&lt;/delete&gt;
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">#####      3.8 更新用户</span><br></pre></td></tr></table></figure>
<p><strong>测试类</strong></p>
<pre><code>User user = new User();
user.setId(41);
user.setUsername(&quot;黄三丫&quot;);
user.setBirthday(new Date());
user.setSex(&quot;1&quot;);
user.setAddress(&quot;广东陆丰&quot;);
sqlSession.insert(&quot;test.updateUser&quot;, user);
//提交事务
sqlSession.commit();
//获取用户信息主键
System.out.println(user.getId());
//关闭会话
sqlSession.close();
</code></pre><p><strong>User.xml</strong></p>
<pre><code>&lt;update id=&quot;updateUser&quot; parameterType=&quot;cn.itcast.po.User&quot;&gt;
    update user set username=#{username},birthday=#{birthday},sex=#{sex},address=#{address} where id=#{id}
&lt;/update&gt;
</code></pre><p><code>`</code></p>
<h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><pre><code>1. parameterType：指定输入参数的类型
2. resultType   ：指定输出结果所映射的java对象类型
3. 如果输入参数是简单类型，#{}中的参数名可以任意
4. 如果传入类型是简单类型的，${}中只能使用value
5. 除了select查询语句之外，其他add，delete，update等增、删、改等语句皆需要提交
6. ${}：表示拼接SQL串，将接收到的参数内容不加任何修饰拼接在SQL中；使用${}拼接SQL，引起SQL注入
        ${}接收输入参数类型可以是简单类型、pojo、hashmap
        如果接收简单类型，${}中只能写成value
        ${}接收pojo对象值，通过OGNL读取对象中的属性值，通过属性.属性.属性...的方式获取对象属性值。
7. #{}：表示一个占位符，#{}接收输入参数类型可以是简单类型、pojo、hashmap
        如果接收简单类型，${}中可以写成value或其他名称
        ${}接收pojo对象值，通过OGNL读取对象中的属性值，通过属性.属性.属性...的方式获取对象属性值。                
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/570911275/570911275.github.io/2019/07/24/JavaEE之MyBatis基础知识之上小结/" data-id="cjyntotu3003lswtn8mwmdow2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javaEE-基础/">javaEE_基础</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/07/24/JavaEE之MyBatis基础知识之中小结/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          JavaEE之MyBatis基础知识之中小结
        
      </div>
    </a>
  
  
    <a href="/2019/07/23/新文档/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/javaEE-基础/">javaEE_基础</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java-基础/">java_基础</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/javaEE-基础/" style="font-size: 20px;">javaEE_基础</a> <a href="/tags/java-基础/" style="font-size: 10px;">java_基础</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/07/26/JavaEE之Spring快速入门之上小结/">JavaEE之Spring快速入门之上小结</a>
          </li>
        
          <li>
            <a href="/2019/07/25/JavaEE之MyBatis高级知识之下小结/">JavaEE之MyBatis高级知识之下小结</a>
          </li>
        
          <li>
            <a href="/2019/07/25/JavaEE之MyBatis高级知识之中小结/">JavaEE之MyBatis高级知识之中小结</a>
          </li>
        
          <li>
            <a href="/2019/07/25/JavaEE之MyBatis高级知识之上小结/">JavaEE之MyBatis高级知识之上小结</a>
          </li>
        
          <li>
            <a href="/2019/07/24/JavaEE之MyBatis基础知识之下小结/">JavaEE之MyBatis基础知识之下小结</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>